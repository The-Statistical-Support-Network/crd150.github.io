<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Lab 6: Point Pattern Analysis</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">CRD 150: Winter 2020</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="syllabus.html">Syllabus</a>
</li>
<li>
  <a href="hw_guidelines.html">Assignment Guidelines</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Labs/Assignments
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="lab1.html">Lab 1</a>
    </li>
    <li>
      <a href="lab2.html">Lab 2</a>
    </li>
    <li>
      <a href="lab3.html">Lab 3</a>
    </li>
    <li>
      <a href="lab4.html">Lab 4</a>
    </li>
    <li>
      <a href="lab5.html">Lab 5</a>
    </li>
    <li>
      <a href="lab6.html">Lab 6</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="eligible.html">Eligible Communities</a>
    </li>
    <li>
      <a href="ndata.html">Neighborhood Data Sources</a>
    </li>
    <li>
      <a href="bigopendata.html">Big and Open Data Sources</a>
    </li>
    <li>
      <a href="nhgis.html">Using NHGIS</a>
    </li>
    <li>
      <a href="policymap.html">Using PolicyMap</a>
    </li>
    <li>
      <a href="missingdata.html">Missing Data</a>
    </li>
    <li>
      <a href="georeferencing.html">Mapping Coordinates</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Lab 6: Point Pattern Analysis</h1>
<h3 class="subtitle"><h4 style="font-style:normal">
CRD 150 - Quantitative Methods in Community Research
</h4></h3>
<h4 class="author"><h4 style="font-style:normal">
Professor Noli Brazil
</h4></h4>
<h4 class="date"><h4 style="font-style:normal">
February 14, 2020
</h4></h4>

</div>


<style>
p.comment {
background-color: #DBDBDB;
padding: 10px;
border: 1px solid black;
margin-left: 25px;
border-radius: 5px;
font-style: italic;
}

.figure {
   margin-top: 20px;
   margin-bottom: 20px;
}

h1.title {
  font-weight: bold;
  font-family: Arial;  
}

h2.title {
  font-family: Arial;  
}

</style>
<style type="text/css">
#TOC {
  font-size: 13px;
  font-family: Arial;
}
</style>
<p><br />
</p>
<p>In our journey into spatial R, we’ve been exclusively working with polygon data. In this guide you will learn how to handle and descriptively analyze point data in R. The objectives of the guide are as follows</p>
<ol style="list-style-type: decimal">
<li>Learn basic spatial point data operations</li>
<li>Learn how to map point data</li>
<li>Learn how to examine point patterns</li>
</ol>
<p>The guide will use data from the <a href="https://datasf.org/opendata/">San Francisco Open Data Portal</a>. Specifically, we will examine the spatial distribution of car break ins, which has gotten a lot of recent <a href="https://www.sfchronicle.com/news/article/Gone-in-5-seconds-SF-neighborhood-police-12545144.php">public attention</a>.</p>
<p>This lab guide follows closely and supplements the material presented in Chapters 2.4, 2.5, 4.2 and 6 in the textbook <a href="https://geocompr.robinlovelace.net/">Geocomputation with R</a> (GWR) and Chapter 5 in the textbook <a href="https://onlinelibrary.wiley.com/doi/book/10.1002/9780470549094">Geographic Information Analysis</a>.</p>
<p class="comment" , style="font-style:normal">
<strong>Assignment 6 is due by 11:59 pm, February 20th on Canvas.</strong> See <a href="https://crd150.github.io/hw_guidelines.html">here</a> for assignment guidelines. You must submit an <code>.Rmd</code> file and its associated <code>.html</code> file. Name the files: yourLastName_firstInitial_asgn06. For example: brazil_n_asgn06.
</p>
<div style="margin-bottom:25px;">

</div>
<div id="open-up-a-r-markdown-file" class="section level2">
<h2><strong>Open up a R Markdown file</strong></h2>
<p><br />
Download the <a href="https://raw.githubusercontent.com/crd150/data/master/labtemplate.Rmd">Lab template</a> into an appropriate folder on your hard drive (preferably, a folder named ‘Lab 6’), open it in R Studio, and type and run your code there. Change the title (“Lab 6”) and insert your name and date. Don’t change anything else inside the YAML (the stuff at the top in between the <code>---</code>).</p>
<div style="margin-bottom:25px;">

</div>
</div>
<div id="installing-and-loading-packages" class="section level2">
<h2><strong>Installing and loading packages</strong></h2>
<p><br />
You’ll need to install the following package in R. We’ll talk about what this package provides as its relevant functions come up in the guide.</p>
<pre class="r"><code>install.packages(&quot;spatstat&quot;)
install.packages(&quot;tmaptools&quot;)</code></pre>
<p>When you install, R might ask you the following question: Do you want to install from sources the package which needs compilation?</p>
<p><br></p>
<p>Politely type in “no” and press enter/return.</p>
<p><br></p>
<p>You’ll need to load the following packages. Unlike installing, you will always need to load packages whenever you start a new R session. You’ll also always need to use <code>library()</code> in your R Markdown file.</p>
<pre class="r"><code>library(sf)
library(sp)
library(tidyverse)
library(tidycensus)
library(tigris)
options(tigris_class = &quot;sf&quot;)
library(tmap)
library(rmapshaper)
library(units)
library(tmaptools)
library(spatstat)</code></pre>
<div style="margin-bottom:25px;">

</div>
</div>
<div id="bringing-in-data" class="section level2">
<h2><strong>Bringing in data</strong></h2>
<p><br />
First, download a zipped file of the shapefile data we will be using in this lab from GitHub using the following code.</p>
<pre class="r"><code>download.file(url = &quot;https://raw.githubusercontent.com/crd150/data/master/lab6files.zip&quot;, destfile = &quot;lab6files.zip&quot;)
unzip(zipfile = &quot;lab6files.zip&quot;)</code></pre>
<p>The files were downloaded into your current working directory folder (see <code>getwd()</code>).</p>
<p>Second, read San Francisco city boundary shapefile data into R using the function <code>st_read()</code></p>
<pre class="r"><code>sanfran.city &lt;- st_read(&quot;sfcity.shp&quot;)</code></pre>
<p>Third, read San Francisco city tract shapefile data</p>
<pre class="r"><code>sanfran.tracts &lt;- st_read(&quot;sftracts.shp&quot;)</code></pre>
<p>The file contains total population (<em>tpop</em>), percent non-Hispanic white (<em>pnhwhite</em>), percent non-Hispanic Asian (<em>pnhasn</em>), percent non-Hispanic black (<em>pnhblk</em>), and percent Hispanic (<em>phisp</em>).</p>
<p>Finally, read in San Francisco point data of car break ins in 2017</p>
<pre class="r"><code>sanfran.breakins &lt;- st_read(&quot;sfbreakins.shp&quot;)</code></pre>
<p>Notice that we have 27,444 break ins with 8 attributes. The geometry type is <em>POINT</em>. Do a <code>View()</code> of the data to see the data.</p>
<p>In lecture, I went through the steps for downloading a csv file of car break ins from the San Francisco open data portal. The next step is to use the longitude (X) and latitude (Y) information to transform the data into a point spatial object. How do you do that? It is a bit complex, as you need to understand the concept of a Coordinate Reference System (CRS). Check the mini lab on <a href="https://crd150.github.io/georeferencing.html">georeferencing</a> to understand how we converted the csv into the <em>sfbreakins.shp</em> file you read in above. We also uploaded a brief handout on Canvas (Week 6 readings folder - OverviewCoordinateReferenceSystems.pdf) that briefly describes CRS. Although this lab guide and all assignments will not require you to understand the material presented in the CRS mini lab and handout, I encourage you to read them carefully if you are planning to use point data in your final project.</p>
<p>You should get a map that looks like</p>
<pre class="r"><code>tm_shape(sanfran.city) +
  tm_polygons() +
tm_shape(sanfran.breakins) +  
  tm_dots(col=&quot;red&quot;)</code></pre>
<p><img src="lab6_files/figure-html/unnamed-chunk-7-1.png" /><!-- --></p>
<p>Welcome to <a href="https://www.youtube.com/watch?v=tNG62fULYgI">San</a> <a href="https://www.youtube.com/watch?v=SC73kdOL5hk">Francisco!</a></p>
<div style="margin-bottom:25px;">

</div>
<div id="spatstat-package" class="section level3">
<h3><strong>spatstat package</strong></h3>
<p><br />
As we learned in <a href="https://crd150.github.io/lab5.html">Lab 5</a> when we calculated spatial autocorrelation, <strong>sf</strong> spatial objects are not compatible with many spatial functions. This is the case here with spatial point pattern analysis methods. We will be using the package <strong>spatstat</strong>, which has a number of useful functions for point pattern analysis. The downside is that it introduces yet another object class: <strong>ppp</strong> objects. Fortunately, the package is <a href="http://spatstat.github.io/">well documented</a> and is not too difficult to get used to. As we have done with <strong>sp</strong>, we’ll limit the nuts and bolts of how <strong>ppp</strong> objects work, and we’ll stick to <strong>sf</strong> point objects whenever possible.</p>
<p>There is no function that directly converts <strong>sf</strong> to <strong>ppp</strong>. We’ll need to convert <em>sanfran.breakins</em> first to an <strong>sp</strong> object using the <code>as()</code> function, which is a part of the <strong>sf</strong> package and was described in <a href="https://crd150.github.io/lab5.html#sf_vs_sp_spatial_objects">Lab 5</a>.</p>
<pre class="r"><code>sanfran.breakins.sp &lt;- as(sanfran.breakins, &quot;Spatial&quot;)</code></pre>
<p>Then convert this <strong>sp</strong> point object to a <strong>ppp</strong> object using <code>as()</code></p>
<pre class="r"><code>sanfran.breakins.ppp &lt;- as(sanfran.breakins.sp, &quot;ppp&quot;)</code></pre>
<p>Before we start running the point pattern analyses described in OSU Chapter 5, we need to clean the <em>sanfran.breakins.ppp</em> a bit.</p>
<p>First, note that a <em>ppp</em> object may or may not have variables or attribute information. In the <strong>spatstat</strong> world, variables are referred to as <em>marks</em>.</p>
<p>In this lab we will only concern ourselves with the pattern generated by the points and not their attributes. We therefore remove all variables or marks from the point object by using the <code>marks()</code> function and setting it to <code>NULL</code></p>
<pre class="r"><code>marks(sanfran.breakins.ppp)  &lt;- NULL</code></pre>
<p>Second, many point pattern analyses need to have their study boundaries explicitly defined. This is the window through which we are observing the points. In this lab’s case study, the City of San Francisco is our study boundary or window. <strong>spatstat</strong> uses a special boundary object - an <em>owin</em>, which stands for observation window. We will need to coerce <em>sanfran.city</em> to an object of class <em>owin</em> using the function <code>as.owin()</code>. Similar to the <strong>sf</strong> to <strong>ppp</strong> conversion, you need to convert <strong>sf</strong> objects first to <strong>sp</strong> to coerce it into a <em>owin</em> object</p>
<pre class="r"><code>sanfran.city.sp &lt;- as(sanfran.city, &quot;Spatial&quot;)</code></pre>
<p>And then use the function <code>as.owin()</code> to convert <em>sanfran.city.sp</em> to an <em>owin</em> object</p>
<pre class="r"><code>sanfran.city.owin &lt;- as.owin(sanfran.city.sp)
class(sanfran.city.owin)</code></pre>
<pre><code>## [1] &quot;owin&quot;</code></pre>
<p>Third, you need to set or “bind” the city boundary <em>sanfran.city.owin</em> to the <em>sanfran.breakins.ppp</em> point feature object to establish the study window. Use the <code>Window()</code> function, which is a <strong>spatstat</strong> function.</p>
<pre class="r"><code>Window(sanfran.breakins.ppp) &lt;- sanfran.city.owin</code></pre>
<p>Let’s plot <em>sanfran.breakins.ppp</em> and <em>sanfran.city.owin</em> and see what we get.</p>
<pre class="r"><code>plot(sanfran.city.owin, col=&#39;light blue&#39;)
points(sanfran.breakins.ppp, col=&#39;red&#39;, cex=.5, pch=&#39;+&#39;)</code></pre>
<p><img src="lab6_files/figure-html/unnamed-chunk-14-1.png" /><!-- --></p>
<p>It might take some time before the break ins appear because there are over 27,000 of them. You’ll notice that rather than <code>ggplot()</code> or <code>tm_shape()</code>, we rely on the basic <code>plot()</code> function to map the points. Part of this is due to <strong>ppp</strong> and <em>owin</em> objects not working well with <code>ggplot()</code> and <code>tm_shape()</code>. Another reason is that the purpose of this specific lab is to do analysis and less about presenting your results, and <code>plot()</code> is a quick and dirty way to visualize our data. We do provide a few presentation-ready maps below using <code>tm_shape()</code> where applicable.</p>
<p>Were now ready to do some point pattern analyses. Huzzah!</p>
<div style="margin-bottom:25px;">

</div>
</div>
</div>
<div id="centrography" class="section level2">
<h2><strong>Centrography</strong></h2>
<p><br />
Before considering more complex approaches, let’s compute the mean center and standard distance for the break in data as described on page 125 of OSU. To calculate these values, you’ll need to extract the x and y coordinates from the <em>sanfran.breakins.ppp</em> object using the function <code>coords()</code></p>
<pre class="r"><code>xy &lt;- coords(sanfran.breakins.ppp)
xy</code></pre>
<p>And then compute the mean center following equation 5.1 on page 125. We’ll use our best bud <code>summarize()</code> to help us out here.</p>
<pre class="r"><code># mean center
mc &lt;- summarize(xy, xmean = mean(x), ymean = mean(y))
mc</code></pre>
<pre><code>##      xmean   ymean
## 1 550552.1 4181222</code></pre>
<p>And then standard distance using equation 5.2 on page 125.</p>
<pre class="r"><code># standard distance
sqrt(sum((xy[,1] - mc[1])^2 + (xy[,2] - mc[2])^2) / nrow(xy))</code></pre>
<pre><code>## [1] 19.80844</code></pre>
<div style="margin-bottom:25px;">

</div>
</div>
<div id="wednesday-lecture-setup" class="section level2">
<h2><strong>Wednesday lecture setup</strong></h2>
<p><br />
We went through the <strong>spatstat</strong> package during Monday’s lecture. We brought in car break in shapefile data, converted the data into a <strong>ppp</strong> object, and cleaned it up for analysis by unmarking it and setting its observation window. We’ll now go through the different methods to analyze point data. Before we do so, we’ll need to recreate our data from Monday.</p>
<p>First, install the following packages if you have not already done so (we did this during Monday’s lecture)</p>
<pre class="r"><code>install.packages(&quot;spatstat&quot;)
install.packages(&quot;tmaptools&quot;)</code></pre>
<p>If you get the question “Do you want to install from sources the package which needs compilation?”, type in “no” and press return/enter.</p>
<p>Next, load the following packages</p>
<pre class="r"><code>library(sf)
library(sp)
library(tidyverse)
library(tidycensus)
library(tigris)
options(tigris_class = &quot;sf&quot;)
library(tmap)
library(rmapshaper)
library(units)
library(tmaptools)
library(spatstat)</code></pre>
<p>Next, bring in the data</p>
<pre class="r"><code>download.file(url = &quot;https://raw.githubusercontent.com/crd150/data/master/lab6files.zip&quot;, destfile = &quot;lab6files.zip&quot;)
unzip(zipfile = &quot;lab6files.zip&quot;)

sanfran.city &lt;- st_read(&quot;sfcity.shp&quot;)
sanfran.tracts &lt;- st_read(&quot;sftracts.shp&quot;)
sanfran.breakins &lt;- st_read(&quot;sfbreakins.shp&quot;)</code></pre>
<p>Finally, convert data to <strong>ppp</strong>, unmark and set window.</p>
<pre class="r"><code>sanfran.breakins.sp &lt;- as(sanfran.breakins, &quot;Spatial&quot;)
sanfran.breakins.ppp &lt;- as(sanfran.breakins.sp, &quot;ppp&quot;)
marks(sanfran.breakins.ppp)  &lt;- NULL
sanfran.city.sp &lt;- as(sanfran.city, &quot;Spatial&quot;)
sanfran.city.owin &lt;- as.owin(sanfran.city.sp)
class(sanfran.city.owin)
Window(sanfran.breakins.ppp) &lt;- sanfran.city.owin</code></pre>
<p>Read the section <strong>spatstat package</strong> to understand what each function is doing.</p>
<div style="margin-bottom:25px;">

</div>
</div>
<div id="point-density" class="section level2">
<h2><strong>Point density</strong></h2>
<p><br />
Centrography is rather dull because it ignores spatial variation in the data. Instead, we can explicitly examine the distribution of points across a geographic area. This is measuring first-order effects. First-order effects or patterns look at trends over space and are typically measured by point density.</p>
<div style="margin-bottom:25px;">

</div>
<div id="overall-density" class="section level3">
<h3><strong>Overall density</strong></h3>
<p><br />
The overall density given in equation 5.3 in OSU on page 126 can be calculated as follows</p>
<pre class="r"><code>CityArea &lt;- as.numeric(st_area(sanfran.city))
nrow(xy) / CityArea</code></pre>
<pre><code>## [1] 0.0002223546</code></pre>
<p>The code <code>as.numeric(st_area(sanfran.city))</code> calculates the area (in meters squared) of San Francisco city, which represents the value <em>a</em> in formula 5.3. <code>nrow(xy)</code> represents the number of break ins in the city, which represents the value <em>n</em>.</p>
<p>Overall density is a little bit better than the centrography measures, but it is still a single number, and thus we can do better. As OSU states on page 127, we lose a lot of information when we calculate a single summary statistic like overall density. Let’s go through the two “local” density approaches covered in OSU: Quadrat and Kernel density. We’ll also go back to our old friend the census tract to discuss an important spatial point operation, summing up points in polygons.</p>
<div style="margin-bottom:25px;">

</div>
</div>
<div id="quadrat-counts" class="section level3">
<h3><strong>Quadrat counts</strong></h3>
<p><br />
A popular first-order method is to calculate quadrat counts, as is discussed on page 127 in OSU. Here, we break up the area into equally sized cells and count the number of points that fall into each cell.</p>
<p>We can carry out a simple quadrat analysis on our data using the <code>quadratcount()</code> function in the <strong>spatstat</strong> package. You have to specify the number of cells in your area. Here, we make a 6 x 6 grid (<code>nx = 6, ny = 6</code>), count the number of points within each of the 36 cells.</p>
<pre class="r"><code>qcounts1&lt;-quadratcount(sanfran.breakins.ppp, nx = 6, ny = 6)</code></pre>
<p>The object <em>qcounts1</em> stores the number of points inside each quadrat. You can plot the quadrats along with the counts as follows.</p>
<pre class="r"><code>#First, plot the city and points
plot(sanfran.breakins.ppp, pch=20, cols=&quot;grey70&quot;, main=NULL)
#The plot the cells and counts 
plot(qcounts1, col = &quot;red&quot;, add=TRUE)</code></pre>
<p><img src="lab6_files/figure-html/unnamed-chunk-24-1.png" /><!-- --></p>
<p>The plot tells us that there are 63 break ins in the cell located on the bottom left corner of the city grid.</p>
<p>Six-by-six might be too small. Let’s instead make a 40 by 40 grid.</p>
<pre class="r"><code>#dont plot qcounts - 40 x 40 grid wont show you much
qcounts2&lt;-quadratcount(sanfran.breakins.ppp, nx = 40, ny = 40)</code></pre>
<p>In real life one should always try a range of row and column sizes to get a sense of how sensitive the results are.</p>
<p>These are neat plots, but let’s try to numerically summarize them. One measure that OSU offers is the variance-mean ratio (VMR), which is described on page 130. We’ll need to convert the resulting <em>qcounts2</em> object into a regular data frame to calculate the VMR. Use the <code>data.frame()</code> function.</p>
<pre class="r"><code>Qcount&lt;-data.frame(qcounts2)</code></pre>
<p>Following page 130 in OSU, we can get a basic measure of the spatial arrangement of points by calculating the VMR of the quadrat counts</p>
<pre class="r"><code>var(Qcount$Freq)/mean(Qcount$Freq)</code></pre>
<pre><code>## [1] 174.0279</code></pre>
<p>OSU states a VMR greater than 1.0 indicates a tendency towards clustering. We get 171.6. Wow, that is super duper huge!</p>
<p>We can employ the Chi-square test for spatial randomness that OSU describes on page 142-43 using the handy dandy <code>quadrat.test()</code> function. The null is spatial randomness.</p>
<pre class="r"><code>quadrat.test(sanfran.breakins.ppp, nx = 40, ny = 40)</code></pre>
<pre><code>## 
##  Chi-squared test of CSR using quadrat counts
## 
## data:  sanfran.breakins.ppp
## X2 = 213043, df = 1303, p-value &lt; 2.2e-16
## alternative hypothesis: two.sided
## 
## Quadrats: 1304 tiles (irregular windows)</code></pre>
<p>Do we reject the null? Why?</p>
<div style="margin-bottom:25px;">

</div>
</div>
<div id="points-in-polygons" class="section level3">
<h3><strong>Points in polygons</strong></h3>
<p><br />
Rather than use quadrats, we can instead use census tracts, which is the standard definition of a neighborhood in the United States. We want to count the number of break ins in each census tract. To do this, we need to use a combination of the functions <code>lengths()</code> and <code>st_intersects()</code>. We won’t need any <strong>spatstat</strong> functions, so we go back to our <strong>sf</strong> objects <em>sanfran.tracts</em> and <em>sanfran.breakins</em>.</p>
<pre class="r"><code>sanfran.tracts &lt;- mutate(sanfran.tracts, breakins = lengths(st_intersects(sanfran.tracts, sanfran.breakins)))</code></pre>
<p>Let’s break this code down to understand what was done. The code <code>st_intersects(x = sanfran.tracts, y = sanfran.breakins)</code> produces a <a href="http://r4ds.had.co.nz/lists.html">list</a> object. Let’s actually view it so we have a clear idea of what this code is producing</p>
<pre class="r"><code>View(st_intersects(sanfran.tracts, sanfran.breakins))</code></pre>
<p>We have a list of 194 vectors, which corresponds to the number of census tracts in San Francisco. Each vector specifies the row number of the car break ins that are intersecting with the tract corresponding to the <em>sanfran.breakins</em>. For example, the first tract contains 1,558 car break ins. In the <em>sanfran.breakins</em> object, these break ins are individually located in row numbers 40, 43, 56 and so on.</p>
<p>The code <code>lengths(st_intersects(sanfran.tracts, sanfran.breakins))</code> provides the length of each vector in the list. Length of each vector corresponds to the number of car break ins in each tract.</p>
<pre class="r"><code>lengths(st_intersects(sanfran.tracts, sanfran.breakins))</code></pre>
<pre><code>##   [1] 1558 1069  207   94  667   55   71   28  106  101  256   49   64  480   79
##  [16]   28   54  213  161   99  285   72   75   86  730  127   59   18   75  472
##  [31]  324   70  116   84   66   83   70   38   49  110  275  267   67   94  583
##  [46]   81  227  100   96  541  272  222  382  205  359   53  185  116   95  132
##  [61]  159   48   68   47  954  598  263  559 2002  460  207  135   44  121   80
##  [76]  236  176  269  113   73   50   24   19   28   44   34   83   85  422  172
##  [91]   86  221   23   30   28   25   41   29   13   14   28   38   38   38   38
## [106]   90   88   41   15   22   84   33   36  111   10   25   22    7   16   18
## [121]   48   34   12    8    7   22   19   19    6   18   50   70   59   42   35
## [136]   51   22   25   49   76  104   71   72   32   13   24   23   26   66   16
## [151]   36   29   32   24   28   55   48  149   20   28   35   21   39   20   25
## [166]   87  198   92   36   53   29   29  171   77   66   10   16   23  468   46
## [181]   43  107    6  361   34  171   37   71  741   20  808   47    8  200</code></pre>
<p>The first tract has 1,558 break ins, the second has 1,069, and so on.</p>
<p>The code <code>breakins = lengths(st_intersects(sanfran.tracts, sanfran.breakins))</code> saves the number of car break ins as a new variable <em>breakins</em>. Putting this code within <code>mutate()</code> saves the new variable in the data frame <em>sanfran.tracts</em>. Type in <code>View(sanfran.tracts)</code>, scroll all the way right, and you should see the variable <em>breakins</em>.</p>
<p>We can map the count of break ins by census tract, but counts do not take into consideration exposure. In this case, tracts that are larger in size or greater in population will likely have more break ins. Let’s calculate the number of break ins per 100 population.</p>
<pre class="r"><code>sanfran.tracts&lt;-mutate(sanfran.tracts,bpop = (breakins/tpop)*100)</code></pre>
<p>The code creates the variable <em>bpop</em> in the tibble <em>sanfran.tracts</em>, which represents the number of break ins per 100 population.</p>
<p>Let’s create a presentable choropleth map of break ins per 100 population.</p>
<pre class="r"><code>tm_shape(sanfran.tracts, unit = &quot;mi&quot;) +
  tm_polygons(col = &quot;bpop&quot;, style = &quot;quantile&quot;,palette = &quot;Reds&quot;, 
              border.alpha = 0, title = expression(&quot;break ins per 100 pop&quot;)) +
  tm_compass(position = c(&quot;left&quot;, &quot;bottom&quot;)) +
  tm_scale_bar(position = c(&quot;left&quot;, &quot;bottom&quot;)) +
  tm_style(&quot;natural&quot;, title = &quot;Car break ins in San Francisco\nTracts 2017&quot;,  title.size = 0.95, frame=FALSE)</code></pre>
<p><img src="lab6_files/figure-html/unnamed-chunk-33-1.png" /><!-- --></p>
<div style="margin-bottom:25px;">

</div>
</div>
</div>
<div id="point-intensity-heat-maps" class="section level2">
<h2><strong>Point intensity heat maps</strong></h2>
<p><br />
In Chapter 3 of OSU, the authors describe the use of kernel density (heat) maps to show the spatial patterns of points. Because there is a bit of math behind the creation of these maps, we won’t go into the specifics in super detail. But, they are cool looking and as long as you understand broadly how these maps are created and what they are showing, they are a good exploratory tool. Also, a benefit of using a kernel density map to visually present your point data is that it does away with predefined areas like quadrats or census tracts. Your point space becomes continuous.</p>
<p>We use the function <code>smooth_map()</code> to create a kernel density map. This function is in the package <strong>tmaptools</strong>. Here, we don’t need to stay within the <strong>ppp</strong> world, so let’s revert back to our <strong>sf</strong> objects.</p>
<pre class="r"><code>ds &lt;- smooth_map(sanfran.breakins, bandwidth = 0.5, cover = sanfran.city, unit = &quot;mi&quot;, style = &quot;quantile&quot;)
class(ds)</code></pre>
<p>The most important parameter we need to set in <code>smooth_map()</code> is the <code>bandwidth</code>, which represents the radius of the kernel function. Think of the bandwidth as a smoothing parameter, where the larger it is, the smoother the map. We set this to 0.5, which represents 0.5 miles (we’ll specify miles using <code>unit = &quot;mi&quot;</code> as an option within the function). We’ll also need to specify the argument <code>cover</code> which specifies the boundaries of the map (SF boundaries). We use <code>quantile</code> to define the color style, but as outlined in <a href="https://crd150.github.io/lab4.html#tmap">Week 4’s lab</a>, there are other methods. You must save the result of <code>smooth_map()</code> into an object, which in our case is <em>ds</em>.</p>
<p>The resulting object is a list. The specific object in <em>ds</em> that you’ll need to map is <em>ds$polygons</em> and the variable within <em>ds$polygons</em> that contains the smoothed values is <em>level</em>. Let’s map <em>ds$polygons</em> on top of <em>sanfran.city</em> to see what we get.</p>
<pre class="r"><code>tm_shape(ds$polygons) + tm_fill(col = &quot;level&quot;,
  palette = &quot;YlOrRd&quot;, border.alpha = 0) +
  tm_shape(sanfran.city) + tm_borders()</code></pre>
<p><img src="lab6_files/figure-html/unnamed-chunk-35-1.png" /><!-- --></p>
<p>and make the map look more presentable</p>
<pre class="r"><code>tm_shape(ds$polygons) + tm_fill(col = &quot;level&quot;,
  palette = &quot;YlOrRd&quot;, border.alpha = 0, title = expression(&quot;break ins&quot;)) +
  tm_shape(sanfran.city) + tm_borders() +
  tm_compass(position = c(&quot;left&quot;, &quot;bottom&quot;)) +
  tm_scale_bar(position = c(&quot;right&quot;, &quot;bottom&quot;)) +
  tm_style(&quot;natural&quot;, title = &quot;Car break ins San Francisco Tracts\n2017&quot;,  title.size = 0.95, frame=FALSE, legend.position = c(&quot;right&quot;, &quot;top&quot;))</code></pre>
<p><img src="lab6_files/figure-html/unnamed-chunk-36-1.png" /><!-- --></p>
<p>Setting the bandwidth can really change your results. My suggestion is to test different bandwidth values. Or choose a bandwidth that makes sense given the city (e.g. big vs. small) and/or context (e.g. walking vs. driving) you are studying. In Los Angeles, you might use a larger bandwidth because it is a large city and people typically drive from place-to-place. In contrast, you might use a smaller bandwidth in New York because it is dense and people typically go from place-to-place by foot or subway.</p>
<p>To summarize, quadrats capture density by cutting up the study area into equally sized cells. Point in polygons capture density by using a pre-defined administrative boundary like census tracts (that should make contextual sense). Kernel density maps also use cells, but smooths (or <a href="https://mgimond.github.io/Spatial/interpolation-in-r.html">interpolates</a>) values across the study area to make a continuous surface.</p>
<div style="margin-bottom:25px;">

</div>
</div>
<div id="distance-based-methods" class="section level2">
<h2><strong>Distance based methods</strong></h2>
<p><br />
As detailed in OSU Ch. 5 page 130, there are a handful of distance (nearest neighbor) based methods for determining whether spatial points are clustered across a geographic space. Methods that measure the relationship between points, in this case their distance from one another, are capturing second-order effects.</p>
<div style="margin-bottom:25px;">

</div>
<div id="mean-nearest-neighbor-distance" class="section level3">
<h3><strong>Mean nearest-neighbor distance</strong></h3>
<p><br />
The first distance-based method that OSU goes through is calculating the average nearest neighbor distance. Here, you calculate for each point the distance to its nearest neighbor. You do this using the function <code>nndist()</code>, which is a part of the <strong>spatstat</strong> package.</p>
<p>We first plug <em>sanfran.breakins.ppp</em> into <code>nndist()</code>, save that result into an object</p>
<pre class="r"><code>break.ndist &lt;- nndist(sanfran.breakins.ppp)</code></pre>
<p>The object <em>break.ndist</em> contains 27,444 values, corresponding to the 27,444 break ins in San Francisco. Each value represents the distance of each break in to the nearest break in. For example the distance to the nearest break in to the 14th break in listed in <em>break.ndist</em> is</p>
<pre class="r"><code>break.ndist[14]</code></pre>
<pre><code>## [1] 48.80192</code></pre>
<p>Take the mean of these values to get the average nearest-neighbor distance.</p>
<pre class="r"><code>mean(break.ndist)</code></pre>
<pre><code>## [1] 9.242017</code></pre>
<p>We find that the mean nearest distance is 9.24 meters. That’s pretty darn small, but small enough to suggest clustering?</p>
<p>We can formally test whether the mean nearest distance value indicates significant point clustering by using the Clark and Evan’s R statistic described on OSU page 143. The <strong>spatstat</strong> package has the function <code>clarkevans.test()</code> for calculating this statistic and testing whether it is statistically significant from 1 (which indicates no clustering). An R less than 1 that is statistically significant indicates clustering.</p>
<pre class="r"><code>clarkevans.test(sanfran.breakins.ppp)</code></pre>
<pre><code>## 
##  Clark-Evans test
##  No edge correction
##  Z-test
## 
## data:  sanfran.breakins.ppp
## R = 0.27563, p-value &lt; 2.2e-16
## alternative hypothesis: two-sided</code></pre>
<div style="margin-bottom:25px;">

</div>
</div>
<div id="k-function" class="section level3">
<h3><strong>K function</strong></h3>
<p><br />
OSU introduces a set of functions - G, F, and K - that describe the distribution of nearest neighbor distances. Our good friend <strong>spatstat</strong> provides canned functions for estimating these distributions. Let’s calculate K.</p>
<p>Before we do so, two things. First, OSU describes ways to assess spatial clustering inferentially by comparing the observed distribution of nearest neighbor distances to a theoretically derived expectation with “envelopes”. We can do this in R using the <code>envelope()</code> function. Second, OSU on page 137 warns us about edge effects. We went through edge effects as a spatial pitfall back in OSU Ch. 2, so this should not be new to us. R offers 5 edge effect corrections. We’ll use the guard zone correction, which we specify using <code>correction = &quot;border&quot;</code> in the <code>envelope()</code> function. Let’s calculate K and its envelope.</p>
<pre class="r"><code>#this will take a bit
envK &lt;- envelope(sanfran.breakins.ppp, fun = Kest, correction=&quot;border&quot;, nsim = 49)</code></pre>
<p>The argument <code>fun = Kest</code> tells R to calculate the K function (as opposed to the F, G and L functions). The argument <code>nsim = 49</code> tells R to run 49 simulations to get the envelopes. For large point datasets, like break ins in San Francisco, I recommend setting <code>nsim</code> to something less than 100.</p>
<p>Let’s plot the K function to get a figure like the ones shown on OSU page 151.</p>
<pre class="r"><code>plot(envK, main = &quot;K Function&quot;)</code></pre>
<p><img src="lab6_files/figure-html/unnamed-chunk-42-1.png" /><!-- --></p>
<p>It’s hard to see, but R is plotting the envelopes around the dashed red line. They are just really narrow. To calculate G and F, use <code>envelope()</code> in the same way, replacing <code>Kest</code> with <code>Gest</code> and <code>Fest</code>, respectively, in the <code>fun</code> argument.</p>
<p>All the evidence provided thus far - quadrats, Clark Evans test, nearest-neighbor distance, the K function - indicate that break ins significantly cluster. The maps we created help you identify where this clustering occurs.</p>
<div style="margin-bottom:25px;">

</div>
</div>
</div>
<div id="assignment-6" class="section level2">
<h2><strong>Assignment 6</strong></h2>
<p><br />
Download and open the <a href="https://raw.githubusercontent.com/crd150/data/master/yourLastName_firstInitial_asgn06.Rmd">Assignment 6 R Markdown Script</a>. Any response requiring a data analysis task must be supported by code you generate to produce your result. (Just examining your various objects in the “Environment” section of R Studio is insufficient—you must use scripted commands.).</p>
<ol style="list-style-type: decimal">
<li>The following figures show plots of the G function for different sets of points. Indicate the point pattern - Complete Spatial Randomness or Clustered - in each plot. (1 point each)</li>
</ol>
<center>
<div class="figure">
<img src="hw6fig1.png" />

</div>
</center>
<ol start="3" style="list-style-type: lower-alpha">
<li>For the plot shown in (b), explain what is causing the G function’s staircase shape. (1 point)</li>
</ol>
<p><br></p>
<ol start="2" style="list-style-type: decimal">
<li>The purpose of this question is to introduce you to the world of open data. Specifically, we explore <a href="https://www.govtech.com/dc/articles/What-is-311.html">311 calls for service</a>. 311 is a non-emergency phone number that people can call in many cities to find information about services, make complaints, or report problems like graffiti or road damage. Pick <strong>one</strong> of the following cities and examine its open data readiness for 311 calls by answering the questions that follow.</li>
</ol>
<ul>
<li>New York, NY <a href="https://data.cityofnewyork.us/Social-Services/311-Service-Requests-from-2010-to-Present/erm2-nwe9">(link)</a></li>
<li>San Francisco, CA <a href="https://data.sfgov.org/City-Infrastructure/311-Cases/vw6y-z8j6">(link)</a></li>
<li>Baltimore, MD <a href="https://data.baltimorecity.gov/City-Services/311-Customer-Service-Requests/9agw-sxsr">(link)</a></li>
<li>Kansas City, MO <a href="https://data.kcmo.org/311/311-Call-Center-Service-Requests/7at3-sxhp">(link)</a></li>
</ul>
<ol style="list-style-type: lower-alpha">
<li>Data Quality (2 points)</li>
</ol>
<ul>
<li>Which city did you pick? How many years of data are available?</li>
<li>Can you understand the variables? Is there a codebook that allows you to identify what these variables mean?</li>
<li>Does it have 4 key variables: (1) Date and time of request; (2) Location (is it coordinates, addresses or both?) (3) Description of the call (4) Has the city addressed this call? Describe one other variable from the data that you think might be useful for an analysis.</li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li>Usability (2 points)</li>
</ol>
<ul>
<li>Can you filter the data based on variable values?</li>
<li>Can you map the data from the site? If so, describe one map.</li>
<li>Can you make graphs and plots of the data from the site? If so, describe one graph/plot.</li>
<li>Can you download the data as a csv and open it in Excel?</li>
<li>Can you download the data as a shapefile?</li>
</ul>
<ol start="3" style="list-style-type: lower-alpha">
<li>Data wrangling (2 points)</li>
</ol>
<ul>
<li>Download 2020 data as a csv and open it in Excel. How clean are the data? Do you see any weird characters or major data cleaning needs?</li>
<li>How clean are the variable (column) names? Any space or weird characters in the variable names?</li>
</ul>
<ol start="4" style="list-style-type: lower-alpha">
<li><p>Bring the file into R. Identify the top three 311 requests in 2020 in your city. You must show your R code for this question. (1 point)</p></li>
<li><p>Extra credit (2 points): Produce an interesting map using any of the map types we discussed from OSU Ch. 3 and Ch. 4. You must show your R code. If you need to convert your points to <strong>sf</strong> objects, read the <a href="https://crd150.github.io/georeferencing.html">georeferencing mini lab</a>. Describe your results.</p></li>
</ol>
<p><br></p>
<ol start="3" style="list-style-type: decimal">
<li>In the next two questions, you will be exploring the spatial distribution of Airbnb listings in the City of Oakland. <a href="https://press.airbnb.com/about-us/">Airbnb</a> involves renting an entire home, a room or a shared room, typically from a private citizen. The data were downloaded from Airbnb’s public use <a href="http://insideairbnb.com/get-the-data.html">data site</a>. You will be using the shapefiles <em>oaklandcity.shp</em>, which contains Oakland City boundaries, <em>oaklandtracts.shp</em>, which contains Oakland City tracts, and <em>airbnboak.shp</em>, which contains Airbnb locations in 2017. A record layout of <em>oaklandtracts.shp</em> can be found <a href="https://raw.githubusercontent.com/crd150/data/master/assgn6_tract_codebook.txt">here</a>. I zipped the three shapefiles up and loaded the folder onto GitHub. Use the following code to read the file in.</li>
</ol>
<pre><code>download.file(url = &quot;https://raw.githubusercontent.com/crd150/data/master/assign6files.zip&quot;, destfile = &quot;assign6files.zip&quot;)
unzip(zipfile = &quot;assign6files.zip&quot;)</code></pre>
<ol style="list-style-type: lower-alpha">
<li>Use two first-order approaches to examine the spatial distribution of Airbnb locations in the city. What do your results suggest about the pattern of Airbnb locations? (2 points)</li>
<li>Plot the K function with its envelopes using the <code>correction = &quot;border&quot;</code> correction. What does the K plot suggest about the pattern of Airbnb locations? (2 points)</li>
<li>Plot the F and G functions with their envelopes using a border correction. What do the F and G plots suggest about the pattern of Airbnb locations? (2 points)</li>
</ol>
<p><br></p>
<ol start="4" style="list-style-type: decimal">
<li>Airbnb has received criticism regarding its effects on local communities. See this <a href="https://www.citylab.com/equity/2018/03/what-airbnb-did-to-new-york-city/552749/">article</a> outlining the major criticisms. Let’s descriptively explore the validity of these criticisms in Oakland using our data set.</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Community advocates claim that Airbnb increases rent. What is the correlation between tract-level rent and the number of Airbnb listings per 1,000 housing units? (1 point)</li>
<li>This <a href="https://theconversation.com/airbnb-and-empty-houses-whos-responsible-for-managing-the-impacts-on-our-cities-83959">article</a> contends that Airbnb promotes housing vacancy. Calculate the correlation between percent vacant housing and the number of Airbnb listings per 1,000 housing units. (1 point)</li>
<li>Another claim is that Airbnb locations are in predominantly white, higher income, and gentrifying neighborhoods. What is the correlation between the number of Airbnb listings per 1,000 housing units and percent black, Hispanic, and median household income? (1 point)</li>
<li>Summarize your findings in (a)-(c). (1 point)</li>
</ol>
<hr />
<p>Website created and maintained by <a href="https://nbrazil.faculty.ucdavis.edu/">Noli Brazil</a></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>


</body>
</html>
